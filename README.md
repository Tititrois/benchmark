# MikroORM 4 vs TypeORM benchmark

This benchmark is using SQLite 3, comparing CRUD operations on 10 000 entities.
To use other drivers, run `docker-compose up` first or adjust the configuration
in `perf.ts` file. 

## Running

```sh
# for mikro-orm 
cd mikro-orm
yarn
yarn start sqlite
yarn start mysql
yarn start mariadb
yarn start pg
yarn start mongo
cd ..

# for typeorm 
cd typeorm
yarn
yarn start
cd ..

# for typegoose 
cd typegoose
yarn
yarn start
yarn start lean
cd ..
```

## Results

Measured on MacBook Pro 15" 2018, 2,2 GHz 6 core Intel Core i7, 16 GB RAM

### MikroORM 4.1.0

#### SQLite

```
$ tsc && node --expose-gc perf sqlite
using sqlite driver, 10 rounds (+1 warm up), 10000 items
┌─────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┐
│ (index) │        all         │        find        │       insert       │       update       │       remove       │
├─────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
│   min   │ 448.59757900238037 │ 59.948835000395775 │ 137.00547000020742 │ 146.5099840015173  │ 52.538595996797085 │
│   avg   │ 533.3038656026125  │  72.0622220017016  │ 186.16724830120802 │ 185.62443720027804 │ 89.44995809942483  │
│   max   │ 683.3240760043263  │  86.6236970052123  │ 325.4126980006695  │  333.524457000196  │ 173.16019500046968 │
└─────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┘
```

#### MySQL

```
$ tsc && node --expose-gc perf mysql
using mysql driver, 10 rounds (+1 warm up), 10000 items
┌─────────┬───────────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┐
│ (index) │        all        │        find        │       insert       │       update       │       remove       │
├─────────┼───────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
│   min   │ 521.1512629985809 │ 32.04821600019932  │ 182.64109100401402 │ 186.39944399893284 │ 104.9366270005703  │
│   avg   │ 597.2960870020091 │ 47.456701601296665 │ 219.84057660102843 │ 210.5588261000812  │ 119.43998269960284 │
│   max   │ 664.5617219954729 │ 100.8162510022521  │ 297.6871910020709  │ 235.85626400262117 │ 151.3229089975357  │
└─────────┴───────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┘
```

#### MariaDB

```
$ tsc && node --expose-gc perf mariadb
using mariadb driver, 10 rounds (+1 warm up), 10000 items
┌─────────┬───────────────────┬────────────────────┬────────────────────┬────────────────────┬────────────────────┐
│ (index) │        all        │        find        │       insert       │       update       │       remove       │
├─────────┼───────────────────┼────────────────────┼────────────────────┼────────────────────┼────────────────────┤
│   min   │ 535.8359329998493 │ 34.018216997385025 │ 185.29014000296593 │ 202.94735000282526 │  94.6893649995327  │
│   avg   │ 556.6039019018411 │ 39.25228499993682  │ 196.05337570011616 │ 216.92841390147805 │ 104.36982730031013 │
│   max   │ 595.5263350009918 │ 49.412223003804684 │ 218.72768200188875 │ 256.8998460024595  │ 117.48028500378132 │
└─────────┴───────────────────┴────────────────────┴────────────────────┴────────────────────┴────────────────────┘
```

#### PostgreSQL

```
$ tsc && node --expose-gc perf pg
using pg driver, 10 rounds (+1 warm up), 10000 items
┌─────────┬───────────────────┬───────────────────┬────────────────────┬────────────────────┬───────────────────┐
│ (index) │        all        │       find        │       insert       │       update       │      remove       │
├─────────┼───────────────────┼───────────────────┼────────────────────┼────────────────────┼───────────────────┤
│   min   │ 534.5596690028906 │ 37.39138000458479 │ 221.93356600403786 │ 185.24205400049686 │ 76.01179500669241 │
│   avg   │ 609.0766584016383 │ 47.88886849954724 │ 246.83140230104328 │ 232.98449490070342 │ 81.37189270034432 │
│   max   │ 702.1830100044608 │ 99.88219299912453 │ 369.4957709982991  │ 357.70868400484324 │ 94.77714199572802 │
└─────────┴───────────────────┴───────────────────┴────────────────────┴────────────────────┴───────────────────┘
```

#### MongoDB

```
$ tsc && node --expose-gc perf mongo
using mongo driver, 10 rounds (+1 warm up), 10000 items
┌─────────┬────────────────────┬───────────────────┬────────────────────┬───────────────────┬────────────────────┐
│ (index) │        all         │       find        │       insert       │      update       │       remove       │
├─────────┼────────────────────┼───────────────────┼────────────────────┼───────────────────┼────────────────────┤
│   min   │ 1102.2392740026116 │ 62.47301999479532 │ 217.64977200329304 │ 621.9570010006428 │ 165.04551299661398 │
│   avg   │ 1160.9112211003899 │ 88.90117549747228 │ 260.28914630040526 │ 634.5805022008717 │ 177.1403971016407  │
│   max   │ 1368.4557190015912 │ 142.9381840005517 │ 445.2715760022402  │ 661.6553009971976 │ 196.00069700181484 │
└─────────┴────────────────────┴───────────────────┴────────────────────┴───────────────────┴────────────────────┘
```

## TypeORM 0.2.28

#### SQLite

```
$ tsc && node --expose-gc perf
┌─────────┬────────────────────┬────────────────────┬───────────────────┬────────────────────┬───────────────────┐
│ (index) │        all         │        find        │      insert       │       update       │      remove       │
├─────────┼────────────────────┼────────────────────┼───────────────────┼────────────────────┼───────────────────┤
│   min   │  22255.6241710037  │ 58.75160800293088  │ 5008.209776002914 │ 8489.928576998413  │ 7974.716665998101 │
│   avg   │ 26237.944573501125 │ 62.593694200366734 │ 6056.737191100791 │ 10370.564538799972 │ 9748.049149399996 │
│   max   │ 33831.707760002464 │ 67.02331000193954  │ 7988.379382003099 │ 14184.509104002267 │ 13216.18676699698 │
└─────────┴────────────────────┴────────────────────┴───────────────────┴────────────────────┴───────────────────┘
```

## Typegoose 7.0.0 / Mongoose 5.9.13

#### Lean (find)

```
$ tsc && node --expose-gc perf lean
┌─────────┬────────────────────┬────────────────────┬───────────────────┬───────────────────┬───────────────────┐
│ (index) │        all         │        find        │      insert       │      update       │      remove       │
├─────────┼────────────────────┼────────────────────┼───────────────────┼───────────────────┼───────────────────┤
│   min   │ 15919.574395995587 │ 31.18300200253725  │ 6292.258801002055 │ 5421.608610000461 │ 4049.315637998283 │
│   avg   │ 16429.251372300834 │ 33.895365100353956 │ 6526.210895300284 │ 5643.299899000302 │ 4225.845212899893 │
│   max   │ 16879.489617999643 │ 36.941098000854254 │ 6846.100083000958 │ 6022.973519001156 │ 4481.632338996977 │
└─────────┴────────────────────┴────────────────────┴───────────────────┴───────────────────┴───────────────────┘
```

#### No lean

```
$ tsc && node --expose-gc perf
┌─────────┬────────────────────┬────────────────────┬───────────────────┬───────────────────┬────────────────────┐
│ (index) │        all         │        find        │      insert       │      update       │       remove       │
├─────────┼────────────────────┼────────────────────┼───────────────────┼───────────────────┼────────────────────┤
│   min   │ 15296.184072002769 │ 181.5160260014236  │ 6155.506323002279 │ 5060.034166000783 │ 2915.3680349998176 │
│   avg   │ 16942.224100700765 │ 198.17443860024213 │ 6787.044653500244 │ 5750.40643119961  │ 4206.5985774006695 │
│   max   │ 17827.032002005726 │ 223.63707599788904 │ 7747.748190000653 │ 6245.68645099923  │ 4628.511132001877  │
└─────────┴────────────────────┴────────────────────┴───────────────────┴───────────────────┴────────────────────┘
```
